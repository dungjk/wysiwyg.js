var wysiwyg=function(){"use strict";
/*! wysiwyg.js | https://github.com/wysiwygjs/wysiwyg.js | Apache License (v2) */var e=function(e,t,n){var r;return function(){if(r){if(!n)return;clearTimeout(r)}var o=this,i=arguments;r=setTimeout((function(){r=null,e.apply(o,i)}),t)}},t=function(e,t,n,r){e.addEventListener(t,n,!!r)},n=function(e,t,n,r){e.removeEventListener(t,n,!!r)},r=function(e){e.preventDefault(),e.stopPropagation()},o=function(e,t,n){for(var r=n?t.parentNode:t;r;){if(r===e)return!0;r=r.parentNode}return!1},i=function(e){var t=e.nodeName;return"IMG"==t||"PICTURE"==t||"SVG"==t||"VIDEO"==t||"AUDIO"==t||"IFRAME"==t||"MAP"==t||"OBJECT"==t||"EMBED"==t},a=function(e){var t=window.getSelection();return t.rangeCount>0?t.getRangeAt(0):null},l=function(e,t){if(t){var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}},c=function(e){return!!window.getSelection().isCollapsed},u=function(){var e=window.getSelection();if(!e.isCollapsed)try{e.collapseToEnd()}catch(e){}},s=function(e,t){var n=window.getSelection();if(o(e,n.anchorNode)&&o(e,n.focusNode))return!0;if(!t)return!1;var r=document.createRange();return r.selectNodeContents(e),r.collapse(!1),n.removeAllRanges(),n.addRange(r),!0};return function(f,d){var p,h=d.toolbar,g=d.buttons,v=d.selectionbuttons,m=d.suggester,w=d.interceptenter,b=!!d.hijackmenu,C="string"==typeof f?document.querySelector(f):f,k=C.querySelector("textarea"),E={},S="top"==h,y="bottom"==h,M="demand"==h,L=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},T=function(e,t){e.classList&&e.classList.remove(t)},R=C.querySelector("[contenteditable=true]");if(!R){(R=document.createElement("div")).setAttribute("contentEditable","true");var I=k.placeholder;I&&R.setAttribute("data-placeholder",I),C.insertBefore(R,C.firstChild)}var P=null,N=function(){P&&clearTimeout(P),P=null,L(C,"focus"),M&&L(C,"focused")},H=function(){P||document.activeElement==R||(P=setTimeout((function(){P=null,T(C,"focus")}),50))};t(R,"focus",N),t(R,"blur",H),k&&k.form&&t(k.form,"reset",H);var A=function(e,n){var r=document.createElement("input");r.placeholder="www.example.com",n&&(r.value=n.href),r.autofocus=!0,n&&t(r,"input",(function(e){var t=r.value.trim();t&&(n.href=t)})),t(r,"keypress",(function(e){if(13==(e.which||e.keyCode)){var t=r.value.trim();if(n);else if(t){var o=t;if(/^[a-z0-9]+:\/\//.test(t)||(o="http://"+t),p.getSelectedHTML())p.insertLink(o);else{var i=function(e){return e.replace(/[&<>"]/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[e]||e}))};p.insertHTML('<a href="'+i(o)+'">'+i(t)+"</a>")}}p.closePopup().collapseSelection(),R.focus()}})),L(e,"hyperlink"),e.appendChild(r),window.setTimeout((function(){r.focus(),N()}),1)},x=function(e,n){var o=function(e,t,n){var r,o,i,a,l,c,u,s;switch(c=n*(1-t),u=n*(1-(l=6*e-(a=Math.floor(6*e)))*t),s=n*(1-(1-l)*t),a%6){case 0:r=n,o=s,i=c;break;case 1:r=u,o=n,i=c;break;case 2:r=c,o=n,i=s;break;case 3:r=c,o=u,i=n;break;case 4:r=s,o=c,i=n;break;case 5:r=n,o=c,i=u}var f=Math.floor(255*r).toString(16),d=Math.floor(255*o).toString(16),p=Math.floor(255*i).toString(16);return"#"+(f.length<2?"0":"")+f+(d.length<2?"0":"")+d+(p.length<2?"0":"")+p},i=document.createElement("table");i.style.borderCollapse="collapse";for(var a=1;a<15;++a){for(var l=document.createElement("tr"),c=0;c<25;++c){var u;if(24==c){var s=Math.floor(255/13*(14-a)).toString(16),f=(s.length<2?"0":"")+s;u="#"+f+f+f}else{u=o(c/24,a<=8?a/8:1,a>8?(16-a)/8:1)}var d=document.createElement("td");d.style.backgroundColor=u,d.title=u,t(d,"click",(function(e){var t=this.title;n?p.forecolor(t).closePopup().collapseSelection():p.highlight(t).closePopup().collapseSelection(),r(e)})),l.appendChild(d)}i.appendChild(l)}L(e,"palette"),e.appendChild(i)},D=function(e,t){if(e.size>67108864)t();else{var n=function(n){var r=new FileReader;r.onload=function(r){if(!n||1==n||n>8)return t(e.type,r.target.result);var o=new Image;o.src=r.target.result,o.onload=function(){var r=o.width,i=o.height;if(r>i){r>4096&&(i*=4096/r,r=4096)}else{i>4096&&(r*=4096/i,i=4096)}var a=document.createElement("canvas"),l=a.getContext("2d");switch(a.width=r,a.height=i,l.save(),n>4&&(a.width=i,a.height=r),n){case 2:l.translate(r,0),l.scale(-1,1);break;case 3:l.translate(r,i),l.rotate(Math.PI);break;case 4:l.translate(0,i),l.scale(1,-1);break;case 5:l.rotate(.5*Math.PI),l.scale(1,-1);break;case 6:l.rotate(.5*Math.PI),l.translate(0,-i);break;case 7:l.rotate(.5*Math.PI),l.translate(r,-i),l.scale(-1,1);break;case 8:l.rotate(-.5*Math.PI),l.translate(-r,0)}l.drawImage(o,0,0,r,i),l.restore();var c=a.toDataURL("image/jpeg",.99);t(e.type,c)}},r.onerror=function(e){t()},r.readAsDataURL(e)};if(!window.DataView)return n();var r=new FileReader;r.onload=function(e){var t=e.target.result,r=new DataView(t);if(65496!=r.getUint16(0,!1))return n();for(var o=r.byteLength,i=2;i<o;){if(r.getUint16(i+2,!1)<=8)return n();var a=r.getUint16(i,!1);if(i+=2,65505==a){if(1165519206!=r.getUint32(i+=2,!1))return n();var l=18761==r.getUint16(i+=6,!1);i+=r.getUint32(i+4,l);var c=r.getUint16(i,l);i+=2;for(var u=0;u<c;++u)if(274==r.getUint16(i+12*u,l)){var s=r.getUint16(i+12*u+8,l);return n(s)}}else{if(65280!=(65280&a))break;i+=r.getUint16(i,!1)}}return n()},r.onerror=function(e){t()},r.readAsArrayBuffer(e)}};function B(e,t){for(var n=[],r=0,o=0;o<e.length;++o)!function(o){D(e[o],(function(i,a){for(n[o]=function(){a&&t(i,a)};r in n;)n[r](),r++;r==e.length&&(n=null)}))}(o)}var O,U=function(e,t,n){for(var r=C,o=r.offsetParent;r;){if("static"!=getComputedStyle(r).position)break;t+=r.offsetLeft,n+=r.offsetTop,o=r,r=r.offsetParent}o.appendChild(e);var i=o.getBoundingClientRect(),a=document.documentElement,l=Math.min(window.innerWidth,Math.max(a.offsetWidth,a.scrollWidth)),c=window.innerHeight,u=e.offsetWidth,s=e.offsetHeight;i.left+t<1?t=1-i.left:i.left+t+u>l-1&&(t=Math.max(1-i.left,l-1-i.left-u)),i.top+n<1?n=1-i.top:i.top+n+s>c-1&&(n=Math.max(1-i.top,c-1-i.top-s)),e.style.left=parseInt(t)+"px",e.style.top=parseInt(n)+"px"},W=null,F=function(e,t,n,r){var o=p.activePopup();for(o&&W===t?(T(o,"animate-down"),T(o,"animate-up")):(o=p.openPopup(),L(o,"wysiwyg-popup"),L(o,e?"animate-down":"animate-up"),W=t);o.firstChild;)o.removeChild(o.firstChild);return n(o,r),o},_=function(e,t,n,r){var o=F(!!S,t,n,r),i=C.getBoundingClientRect(),a=e.getBoundingClientRect(),l=a.left-i.left+parseInt(e.offsetWidth/2)-parseInt(o.offsetWidth/2),c=a.top-i.top;S?c+=e.offsetHeight:c-=o.offsetHeight,U(o,l,c)},q=function(e,t){var n=C.getBoundingClientRect(),r=R.getBoundingClientRect(),o=t.left+parseInt(t.width/2)-parseInt(e.offsetWidth/2)+r.left-n.left,i=t.top+t.height+r.top-n.top;U(e,o,i)},X=function(e,t,n,r){var o=F(!0,t,n,r);q(o,e)},z=null,V=null,Y=function(e,n,o,i){o.forEach((function(o){if(o instanceof HTMLElement)return e.appendChild(o),t(o,"focus",N),void t(o,"blur",H);var a=document.createElement("button");if(L(a,"btn"),"icon"in o){var l=document.implementation.createHTMLDocument("");l.body.innerHTML=o.icon;for(var c=l.body.firstChild;null!==c;c=c.nextSibling)a.appendChild(c)}if("attr"in o)for(var u in o.attr)a.setAttribute(u,o.attr[u]);t(a,"focus",N),t(a,"blur",H);var s=null;"click"in o?s=function(){o.click(p,a)}:"popup"in o?s=function(){var e=function(e){o.popup(p,e,a)};n?X(n,e.toString(),e):_(a,e.toString(),e)}:"browse"in o||"dataurl"in o?s=function(){p.closePopup().collapseSelection();var e=document.createElement("input");e.type="file",e.multiple=!0,e.style.display="none",t(e,"change",(function(t){var i="dataurl"in o;if(t.target.files)if("browse"in o)for(var l=n.target.files,c=0;c<l.length;++c)o.browse(p,e,l[c],a);else B(n.target.files,(function(e,t){o.dataurl(p,e,t,a)}));else i=!0;i&&e.parentNode.removeChild(e),r(t)})),C.appendChild(e);var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!1),e.dispatchEvent(n)}:"action"in o&&(s=function(){switch(o.action){case"link":n?X(n,"link",A,V):_(a,"link",A,V);break;case"bold":p.bold().closePopup().collapseSelection();break;case"italic":p.italic().closePopup().collapseSelection();break;case"underline":p.underline().closePopup().collapseSelection();break;case"strikethrough":p.strikethrough().closePopup().collapseSelection();break;case"colortext":n?X(n,"colortext",x,!0):_(a,"colortext",x,!0);break;case"colorfill":n?X(n,"colorfill",x,!1):_(a,"colorfill",x,!1);break;case"subscript":p.subscript().closePopup().collapseSelection();break;case"superscript":p.superscript().closePopup().collapseSelection();break;case"orderedlist":p.orderedList().closePopup().collapseSelection();break;case"unorderedlist":p.unorderedList().closePopup().collapseSelection();break;case"clearformat":p.removeFormat().closePopup().collapseSelection()}}),a.onclick=function(e){s&&s(),r(e)},e.appendChild(a),"hotkey"in o&&s&&i&&(i[o.hotkey.toLowerCase()]=s)}))},K=null,j=1,G=null,J=function(e){e&&p.expandSelection(K.length,0).insertHTML(e),K=null,G=null,j+=1,p.closePopup()},$=e((function(){if(K){var e=j;m(K,(function(n){if(z&&e==j)if(G=null,n){X(z,"suggestion",(function(e){n.forEach((function(n){var o=document.createElement("div");L(o,"suggestion"),o.innerHTML=n.label,t(o,"click",(function(e){J(n.insert),r(e)})),e.appendChild(o),null===G&&(G=n.insert)}))}))}else J()}))||J()}}),100,!0),Q=function(e,t,n,r,o,i){if(w&&13==e&&!n&&!r&&!o&&!i&&(p.sync(),w()))return p.closePopup(),!1;if(t&&!n&&!r&&o&&!i){var a=t.toLowerCase();if(E[a])return E[a](),!1}return m?function(e,t,n,r,o,i){return 13!=e||!G||(J(G),!1)}(e):void 0},Z=function(e,t,n,r,o,i){if(m)return function(e,t,n,r,o,i){switch(e){case 8:if(K&&(K=K.slice(0,-1)),K)break;return J(),!0;case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return K&&J(),!0;default:K||(K=""),K+=t}return $(),!0}(e,t)},ee=function(e,t,n,r){if(z=e?t||z:null,V=null,t)if(e&&null!==K){var o=p.activePopup();o&&(T(o,"animate-down"),T(o,"animate-up"),q(o,t))}else{for(var a=0;a<n.length;++a){var l=n[a],c=l.closest||function(e){for(var t=this;t;){var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;if(n&&n.call(t,e))return t;t=t.parentElement}return null};if(V=c.call(l,"a"))break}var u=!0;r||(v?e?u=!1:n.forEach((function(e){i(e)&&(u=!1)})):u=!1),u?X(t,"selection",(function(e){var n=document.createElement("div");L(n,"toolbar"),e.appendChild(n),Y(n,t,v)})):J()}else J()},te=function(){N()},ne=function(){J(),H()},re=null,oe=null;if(k){!R.innerHTML&&k.value&&(R.innerHTML=k.value);var ie=R.innerHTML;if(re=function(){var e=R.innerHTML;e.match(/^<br[/ ]*>$/i)&&(R.innerHTML="",e=""),e!=ie&&(k.value=e,ie=e)},t(R,"focus",(function(){var e=document.createEvent("Event");e.initEvent("focus",!1,!1),k.dispatchEvent(e)})),t(R,"blur",(function(){re();var e=document.createEvent("Event");e.initEvent("blur",!1,!1),k.dispatchEvent(e)})),oe=e(re,250,!0),t(R,"input",oe),t(R,"propertychange",oe),t(R,"textInput",oe),t(R,"paste",oe),t(R,"cut",oe),t(R,"drop",oe),window.MutationObserver)new MutationObserver(oe).observe(R,{attributes:!0,childList:!0,characterData:!0,subtree:!0});var ae=k.form;ae&&t(ae,"reset",(function(){R.innerHTML="",oe(),O(!0),T(C,"focused")}))}var le=null,ce=null;if(ee){ce=e((function(e,t,n){var r=c(),i=function(e){var t=window.getSelection();if(!t.rangeCount)return[];for(var n=[],r=0;r<t.rangeCount;++r)for(var i=(u=t.getRangeAt(r)).startContainer,a=u.endContainer;i;){if(i!=e){var l=!1;if(t.containsNode)l=t.containsNode(i,!0);else{var c=document.createRange();c.selectNodeContents(i);for(r=0;r<t.rangeCount;++r){var u;if((u=t.getRangeAt(r)).compareBoundaryPoints(u.END_TO_START,c)>=0&&u.compareBoundaryPoints(u.START_TO_END,c)<=0){l=!0;break}}}l&&n.push(i)}i=function(e,t){if(e.firstChild)return e.firstChild;for(;e;){if(e==t)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}(i,i==a?a:e)}return 0==n.length&&o(e,t.focusNode)&&t.focusNode!=e&&n.push(t.focusNode),n}(R),a=null===e||null===t?null:{left:e,top:t,width:0,height:0},l=function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).cloneRange();if((o=t.getBoundingClientRect())&&o.left&&o.top&&o.right&&o.bottom)return{left:parseInt(o.left),top:parseInt(o.top),width:parseInt(o.right-o.left),height:parseInt(o.bottom-o.top)};for(var n=t.getClientRects?t.getClientRects():[],r=0;r<n.length;++r){var o;if((o=n[r]).left&&o.top&&o.right&&o.bottom)return{left:parseInt(o.left),top:parseInt(o.top),width:parseInt(o.right-o.left),height:parseInt(o.bottom-o.top)}}return!1}();if(l&&(a=l),a){var u=R.getBoundingClientRect();a.left-=parseInt(u.left),a.top-=parseInt(u.top),a.left<0&&(a.left=0),a.top<0&&(a.top=0),a.width>R.offsetWidth&&(a.width=R.offsetWidth),a.height>R.offsetHeight&&(a.height=R.offsetHeight)}else if(i.length)for(var s=0;s<i.length;++s){var f=i[s];if(f.nodeType==Node.ELEMENT_NODE){a={left:f.offsetLeft,top:f.offsetTop,width:f.offsetWidth,height:f.offsetHeight};break}}ee(r,a,i,n)}),1)}var ue=null,se=function(e){var t=e.target||e.srcElement;t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),o(ue,t)||fe()},fe=function(){ue&&(ue.parentNode.removeChild(ue),ue=null,n(window,"mousedown",se,!0),ne&&ne())},de=function(e,t){var n=e.which||e.keyCode,o=String.fromCharCode(n||e.charCode),i=e.shiftKey||!1,l=e.altKey||!1,c=e.ctrlKey||!1,u=e.metaKey||!1;if(1==t?Q&&!1===Q(n,o,i,l,c,u)&&r(e):2==t&&Z&&!1===Z(n,o)&&r(e),le&&(le=a()),2!=t&&3!=t||ce&&ce(null,null,!1),2==t&&oe)switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:oe()}};t(R,"keydown",(function(e){de(e,1)})),t(R,"keypress",(function(e){de(e,2)})),t(R,"keyup",(function(e){de(e,3)}));var pe=function(e,t){var r=null,o=null;e.clientX&&e.clientY?(r=e.clientX,o=e.clientY):e.pageX&&e.pageY&&(r=e.pageX-window.pageXOffset,o=e.pageY-window.pageYOffset),(e.which&&3==e.which||e.button&&2==e.button)&&(t=!0),n(window,"mouseup",pe),le&&(le=a()),!b&&t||ce&&ce(r,o,t)},he=null;t(R,"mousedown",(function(e){n(window,"mouseup",pe),t(window,"mouseup",pe),he=e.target})),t(R,"mouseup",(function(e){var t=e.target;if(t&&t.nodeType==Node.ELEMENT_NODE&&t===he&&i(t)&&o(R,t,!0)){var n=window.getSelection(),r=document.createRange();r.setStartBefore(t),r.setEndAfter(t),n.removeAllRanges(),n.addRange(r)}pe(e),oe&&oe()})),t(R,"dblclick",(function(e){pe(e)})),t(R,"selectionchange",(function(e){pe(e)})),b&&t(R,"contextmenu",(function(e){pe(e,!0),r(e)}));var ge=function(e,t,n){if(l(0,le),R.focus(),!s(R,n))return!1;try{return!(document.queryCommandSupported&&!document.queryCommandSupported(e))&&document.execCommand(e,!1,t)}catch(e){}return!1};function ve(e){if(!e)return!1;var t=[];if(e.items)for(var n=e.items,r=0;r<n.length;++r){var o=n[r];if(o.type.match(/^image\//)){var i=o.getAsFile();t.push(i)}}else if(e.files){var a=e.files;for(r=0;r<a.length;++r)t.push(a[r])}return!!t.length&&(B(t,(function(e,t){ge("insertImage",t)})),!0)}if(t(R,"paste",(function(e){ve(e.clipboardData)&&r(e)})),t(R,"drop",(function(e){ve(e.dataTransfer)&&r(e)})),O=function(e){oe&&oe(),e?(u(),le=null):le&&(le=a())},p={sync:function(){return re&&re(),this},getHTML:function(){return R.innerHTML},setHTML:function(e){return R.innerHTML=e||"",O(!0),this},getSelectedHTML:function(){return l(0,le),s(R)?function(e){if(c())return null;var t=window.getSelection();if(t.rangeCount){for(var n=document.createElement("div"),r=t.rangeCount,o=0;o<r;++o){var i=t.getRangeAt(o).cloneContents();n.appendChild(i)}return n.innerHTML}return null}():null},collapseSelection:function(){return u(),le=null,this},expandSelection:function(e,t){return l(0,le),s(R)?(function(e,t,n){var r=window.getSelection();if(r.modify){for(var o=0;o<t;++o)r.modify("extend","backward","character");for(o=0;o<n;++o)r.modify("extend","forward","character")}else{var i=r.getRangeAt(0);i.setStart(i.startContainer,i.startOffset-t),i.setEnd(i.endContainer,i.endOffset+n),r.removeAllRanges(),r.addRange(i)}}(0,e,t),le=a(),this):this},openPopup:function(){return le||(le=a()),function(){if(ue)return ue;t(window,"mousedown",se,!0),ue=document.createElement("DIV");var e=R.parentNode,n=R.nextSibling;return n?e.insertBefore(ue,n):e.appendChild(ue),te&&te(),ue}()},activePopup:function(){return ue},closePopup:function(){return fe(),this},removeFormat:function(){return ge("removeFormat"),ge("unlink"),O(),this},bold:function(){return ge("bold"),O(),this},italic:function(){return ge("italic"),O(),this},underline:function(){return ge("underline"),O(),this},strikethrough:function(){return ge("strikeThrough"),O(),this},forecolor:function(e){return ge("foreColor",e),O(),this},highlight:function(e){return ge("hiliteColor",e)||ge("backColor",e),O(),this},fontName:function(e){return ge("fontName",e),O(),this},fontSize:function(e){return ge("fontSize",e),O(),this},subscript:function(){return ge("subscript"),O(),this},superscript:function(){return ge("superscript"),O(),this},insertLink:function(e){return ge("createLink",e),O(!0),this},insertImage:function(e){return ge("insertImage",e,!0),O(!0),this},insertHTML:function(e){return ge("insertHTML",e,!0)||(l(0,le),s(R,!0),function(e,t){var n=window.getSelection();if(n.getRangeAt&&n.rangeCount){var r=n.getRangeAt(0),i=document.createElement("div");i.innerHTML=t;for(var a,l,c=document.createDocumentFragment();a=i.firstChild;)l=c.appendChild(a);o(e,r.commonAncestorContainer)?(r.deleteContents(),r.insertNode(c)):e.appendChild(c),l&&((r=r.cloneRange()).setStartAfter(l),r.collapse(!0),n.removeAllRanges(),n.addRange(r))}}(R,e)),O(!0),this},orderedList:function(){return ge("insertOrderedList"),O(),this},unorderedList:function(){return ge("insertUnorderedList"),O(),this}},g){var me=document.createElement("div");if(L(me,"toolbar"),S)L(me,"toolbar-top"),C.insertBefore(me,C.firstChild);else if(y)L(me,"toolbar-bottom"),C.appendChild(me);else{var we=document.createElement("div");L(we,"toolbar-auto"),C.appendChild(we),we.appendChild(me)}Y(me,null,g,E)}return p}}();
